import{d as O,r as s,s as L,o as P,c as r,b as l,x as $,e as F,y as W,z as G,v as q,F as k,j as y,h as n,t as A,k as K,w as T,a as N,p as H,i as J,l as Q,M as X,g as V,_ as Y}from"./index-765a7307.js";import{c as Z,g as ee,d as ae}from"./index-cdc21fc1.js";const te=d=>(H("data-v-0357ef06"),d=d(),J(),d),se={class:"search-container"},oe=["onKeydown"],ne={class:"input-result-list"},le=["onClick"],ce={key:0,class:"search-result"},re={key:1,class:"no-result"},ue=te(()=>l("div",{class:"no-result-title"},"无搜索结果，但是推荐新更新游戏",-1)),ie={class:"no-result-list"},de=O({__name:"index",emits:["changeMenu"],setup(d,{emit:b}){const w=Q(),t=s(""),_=s(),m=s(),x=s(""),C=s(),u=s(!1),h=s(),p=s(),S=s(!1),g=s(),i=s(!1),z=async a=>{const o=await ae(a);h.value=o.data,_.value=h.value.map(c=>c.game_name)},D=a=>{var o,c;console.log(a),a!==""&&(C.value=(c=(o=h.value)==null?void 0:o.find(v=>v.game_name===a))==null?void 0:c.game_id,w.push(`/game/${C.value}`))},R=async()=>{if(t.value===""){X.error({content:"搜索值不能为空"});return}const a=await Z(t.value);a.data.length!==0?(u.value=!1,p.value=a.data,t.value=""):(t.value="",u.value=!0)},B=a=>{w.push({name:"game",params:{id:a}})},U=()=>{i.value=!0},j=()=>{i.value=!1},E=()=>{t.value="",i.value=!1};return L(u,async()=>{const a=await ee();g.value=a.data}),L(t,()=>{t.value&&(p.value=[]),clearTimeout(m.value),m.value=setTimeout(()=>{x.value=t.value,z(x.value),clearTimeout(m.value)},200)}),P(()=>{b("changeMenu","item3")}),(a,o)=>{var I,M;const c=V("t-comment"),v=V("t-card");return n(),r("div",se,[l("div",{class:$(["search-title",i.value?"search-title-shrink":null])}," 搜索 ",2),l("div",{class:$(["input-content",["search",i.value?"search-shrink":null]])},[F(l("input",{class:"input-box",type:"text",placeholder:"请输入搜索关键词","onUpdate:modelValue":o[0]||(o[0]=e=>t.value=e),spellcheck:"false",onFocus:U,onBlur:j,onKeydown:[G(R,["enter"]),G(E,["esc"])]},null,40,oe),[[W,t.value,void 0,{trim:!0}]]),F(l("div",ne,[(n(!0),r(k,null,y(_.value,(e,f)=>(n(),r("div",{class:"result-list",key:f},[l("div",{class:"result",onClick:ve=>D(e)},A(e),9,le)]))),128))],512),[[q,((I=t.value)==null?void 0:I.length)&&((M=_.value)==null?void 0:M.length)]])],2),u.value?(n(),r("div",re,[ue,l("div",{class:"close",onClick:o[1]||(o[1]=e=>{g.value=[],u.value=!1})}," 关闭 "),l("div",ie,[(n(!0),r(k,null,y(g.value,e=>(n(),K(v,{key:e.id,class:"home-card",cover:e.game_t_img,theme:"poster2",style:{width:"384px",marginBottom:"20px"},onClick:f=>B(e.game_id),loading:S.value},{footer:T(()=>[N(c,{author:e.game_name},null,8,["author"])]),_:2},1032,["cover","onClick","loading"]))),128))])])):(n(),r("div",ce,[(n(!0),r(k,null,y(p.value,e=>(n(),K(v,{key:e.id,class:"home-card",cover:e.game_t_img,theme:"poster2",style:{width:"384px",marginBottom:"20px"},onClick:f=>B(e.game_id),loading:S.value},{footer:T(()=>[N(c,{author:e.game_name},null,8,["author"])]),_:2},1032,["cover","onClick","loading"]))),128))]))])}}});const he=Y(de,[["__scopeId","data-v-0357ef06"]]);export{he as default};
